<?xml version="1.0" ?>
<ruleset
    name="Custom Ruleset"
    xmlns="http://pmd.sf.net/ruleset/1.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://pmd.sf.net/ruleset/1.0.0 http://pmd.sf.net/ruleset_xml_schema.xsd"
>
    <!--
    To customize PHPMD, import each ruleset, excluding rules that are not needed or need to be
    customized separately.
    @see https://phpmd.org/documentation/creating-a-ruleset.html
    -->

    <exclude-pattern>tests/*</exclude-pattern>

    <rule ref="rulesets/cleancode.xml">
        <!-- Avoiding else expresssions does not help -->
        <exclude name="ElseExpression" />

        <!-- This does not help since = is not === so we don't confuse them. -->
        <exclude name="IfStatementAssignment" />

        <!-- Calling static functions is necessary sometimes. -->
        <exclude name="StaticAccess" />
    </rule>
    <rule ref="rulesets/codesize.xml">
        <!-- Redundant, not visible in code, and not good measurements. -->
        <exclude name="CyclomaticComplexity" />
        <exclude name="ExcessiveClassComplexity" />
        <exclude name="NPathComplexity" />

        <!-- Lumps together public properties and methods so it's redundant -->
        <exclude name="ExcessivePublicCount" />

        <!-- Protected and private properties are not part of the class API -->
        <exclude name="TooManyFields" />

        <!-- Lumps together public, protected, and private methods -->
        <exclude name="TooManyMethods" />

        <!-- Customized below -->
        <exclude name="ExcessiveClassLength" />
        <exclude name="ExcessiveMethodLength" />
        <exclude name="ExcessiveParameterList" />
        <exclude name="TooManyMethods" />
        <exclude name="TooManyPublicMethods" />
    </rule>
    <rule ref="rulesets/controversial.xml" />
    <rule ref="rulesets/design.xml" />
    <rule ref="rulesets/naming.xml" />
    <rule ref="rulesets/unusedcode.xml" />

    <!-- 99% of our PHP classes are less than this length. -->
    <rule ref="rulesets/codesize.xml/ExcessiveClassLength">
        <properties>
            <property name="minimum" value="2500" />
        </properties>
    </rule>

    <!-- 99% of our PHP functions are less than this length. -->
    <rule ref="rulesets/codesize.xml/ExcessiveMethodLength">
        <properties>
            <property name="minimum" value="150" />
        </properties>
    </rule>

    <!-- 99% of our PHP functions are less than this parameter count. -->
    <rule ref="rulesets/codesize.xml/ExcessiveParameterList">
        <properties>
            <property name="minimum" value="8" />
        </properties>
    </rule>

    <!-- 99% of our PHP classes have less public methods, excluding get|set. -->
    <rule ref="rulesets/codesize.xml/TooManyPublicMethods">
        <properties>
            <property name="maxmethods" value="25" />
        </properties>
    </rule>
</ruleset>
